<html lang="en" resource-type="blogpost"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@briankardell">
    <meta name="twitter:creator" content="@briankardell">
    <meta name="twitter:title" content="The Curious Case of MathML, and Why You Should Care">
    <meta name="twitter:description" content="MathML is among a very small group of things that occupy a unique place in Web history. Recently there's been some discussion in the W3C Technical Architecture Group (TAG) about it">
    <meta name="twitter:image" content="https://www.w3.org/MarkUp/htmlplus_paper/math2.gif">
    <link rel="alternate" type="application/rss+xml" href="blog/feed.rss" title="bkardell.com/blog rss feed">
    <title>The Curious Case of MathML, and Why You Should Care</title>
    <style>.captioned-image {
    background-color: #eaeaea;
    display: block;
    overflow: hidden;
    padding: 1rem;
    text-align: center;
    font-style: italic;
}

.captioned-image.p-attached {
    width: 40%;
    display: inline-block;
    margin: 0 1rem 2rem 1rem;
}

section > .captioned-image.p-attached {
    margin-top: 1.5rem; /* correct for heading size*/
}

 pre { overflow-x: auto }

.captioned-image.p-attached.p-attached-left {
    float: left;
}

.captioned-image.p-attached.p-attached-right {
    float: right;
}

.captioned-image.p-attached + * + * {
    clear: both;
    margin-top: 2rem;
}


.captioned-image img, .captioned-image video {
    display: block;
    max-width: 100%;
    margin: 0 auto 1em auto;
}
.source {
    font-style: italic;
}
body {
    display: flex;
    font: 1em "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-weight: 300;
    line-height: 1.625;
}
h1 { margin: 0.5rem; }
code-format {
    border-left: 0.5rem solid rgba(123,115,209,0.35);
    display: block;
    padding: 0.5rem;
    margin-bottom: 1rem;
}

contextual-heading {
    display: block;
    margin-top: 2rem;
}

[aria-level="1"] {
    color: #43686b;
    font-size: 1.45rem;
}
[aria-level="2"] {
    color: #856363;
    font-size: 1.35rem;
}
[aria-level="3"] {
    color: #856363;
    font-size: 1.25rem;
}
[aria-level="4"] {
    color: #856363;
    font-size: 1.2rem;
}
[aria-level="5"], [aria-level="6"] {
    color: #667496;
    font-size: 1.1rem;
    font-weight: bolder;
}
.posted-on {
    font-style: italic;
    font-size: 0.8rem;
    text-align: right;
    margin-bottom: 1rem;
}

ul, li {
    margin: 0.5rem;
    text-align: left;
}
header {
    padding-top: 1rem;
    padding-right: 2rem;
    background-color: #fbf5e9;
}
.tagline {
    font-style: italic;
    text-align: center;
}

[tag-esc] {
    color: maroon;
    font-family: Courier, "Lucida Console", monospace;
}

[tag-esc]::before {
    content: '<';
}

[tag-esc]::after {
    content: '>';
}

main {
    min-width: 50%;
    width: 80%;
    padding: 1rem;
}
header .title {
    background-color: rgba(123,115,209,0.35);
    padding: 0.3rem;
    padding-left: 0.25rem;
    font-weight: bolder;
    font-size: 0.9rem;
    border-left: 1rem solid #999298;
}

header .profile {
    width: 50%;
    margin: 1rem 25%;
}

header .title + nav {
    font-size: 0.9rem;
}

header .blurb {
    font-size: 0.75rem;
    text-align: center;
}
header .name {
    text-align: center;
    font-size: xx-large;
}
.segue {
    font-style: italic;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0,0,0,0);
  border: 0;
}
[for="aboutMeToggle"] {
    display: none;
}
/* this needs rethinking, it wants a selector like 'not flow content' */
article>*:not(contextual-heading,a), section>*:not(contextual-heading,a) {
    margin-left: 0.45rem;
}

blockquote {
  font-family: serif;
  background: #f9f9f9;
  border-left: 10px solid #ccc;
  margin: 1.5em 10px;
  padding: 0.5em 10px;
}
blockquote:before {
  color: #ccc;
  content: open-quote;
  font-size: 2em;
  line-height: 0.1em;
  margin-right: 0.25em;
  vertical-align: -0.4em;
}

blockquote:after {
  color: #ccc;
  content: close-quote;
  font-size: 2em;
  line-height: 0.1em;
  margin-left: 0.25em;
  vertical-align: -0.4em;
}


@media (max-width: 800px){
    body {
        flex-direction: column;
    }
    header {
        border-bottom: 1px solid #afafff;
    }

    .captioned-image.p-attached {
        width: 100%;
        margin: 1rem 0;
    }

    .captioned-image.p-attached.p-attached-left,
    .captioned-image.p-attached.p-attached-right {
        float: none;
    }

    [for="aboutMeToggle"] {
        background-color: #675e5e;
        color: white;
        padding: 0.25rem;
        padding-left: 0.5rem;
        display: block;
        border-left: 1rem solid black;
    }
    #aboutMeToggle:focus + [for="aboutMeToggle"]{
        outline: 4px solid #c6ddf2;
    }

    #aboutMeToggle:checked ~ header {
        display: none;
    }

    header li { display: inline; margin-left: -0.5em; }
    header .blurb li::after { content: '; '; }
    header  nav li {
        display: inline-block;
        margin-left: 0.35rem;
        margin-right: 0.35rem;
    }
    header .title {
        width: 100%;
    }
    main li .source { display: block; }

}</style>
    <style>
      .captioned-image { font-size: 0.9rem; }
      .thanksTo { font-style: italic; font-size: 0.8rem; }
    </style>
    <script>
      var activateOptional = function (media) {
        var source = media.getAttribute('data-src'),
            temp,
            container = media.parentElement;

          if (media.nextSibling && media.nextSibling.matches) {
            if (media.nextSibling.matches('.clickToSee')) {
              media.parentElement.removeChild(media.nextSibling);
            }
          }

          if (media.tagName === 'VIDEO') {
            temp = document.createElement('video')
            temp.setAttribute('autoplay','')
            temp.setAttribute('controls','')
            temp.setAttribute('loop','')
            temp.innerHTML = '<source src="' + source + '.webm" type="video/webm">'
                    + '<source src="' + source + '.mp4" type="video/mp4">';
            media.parentElement.replaceChild(temp, media);
            setTimeout(function () {
              temp.play()
            }, 0);
          } else {
            media.src = media.getAttribute('data-src');
          }

          container.classList.add('active');
      }
    </script>
  </head>
  <body>
    <input id="aboutMeToggle" class="sr-only" type="checkbox" checked="">
<label for="aboutMeToggle">Toggle author information</label>
<header>
    <div class="name">
        Brian Kardell
    </div>
    <img class="profile" src="/profile.jpg" alt="">
    <div class="tagline"><a href="/">Betterifying the Web</a></div>
    <div class="blurb">
        <ul>
            <li>Sr Front-End Engineer at Apollo Group, Inc</li>
            <li>Original Co-author/Co-signer of The Extensible Web Manifesto</li>
            <li>Co-Founder/Chair, W3C Extensible Web CG</li>
            <li>Member, W3C (The JS Foundation)</li>
            <li>Co-author of HitchJS</li>
            <li>Blogger</li>
            <li>Art, Science &amp; History Lover</li>
            <li>Standards Geek</li>
        </ul>
    </div>
    <div class="title">Follow Me On...</div>
    <nav>
        <ul>
            <li><a rel="me" href="https://briankardell.wordpress.com">Wordpress</a></li>
            <li><a rel="me" href="https://medium.com/@briankardell">Medium</a></li>
            <li><a rel="me" href="https://twitter.com/briankardell">Twitter</a></li>
            <li><a rel="me" href="https://github.com/bkardell/">Github</a></li>
            <li><a rel="me" href="https://codepen.io/bkardell">Codepen</a></li>
            <li><a rel="me" href="https://www.linkedin.com/in/brian-kardell-08a4264">LinkedIn</a></li>
            <li><a rel="me" href="https://www.instagram.com/kardellbrian">Instagram (for
art)</a></li>
            <li><a rel="me" href="http://fineartamerica.com/profiles/brian-kardell?">Fine Art
America (art for sale)</a></li>
        </ul>
    </nav>
</header>
    <main><div class="posted-on">Posted on null</div><article class="sectioning">
	<contextual-heading posted-on="02/11/2018" role="heading" aria-level="1">The Curious Case of MathML, and Why You Should Care</contextual-heading>
	<p class="segue">
		MathML is among a very small group of things that occupy a unique place in Web history. Recently there's been some <a href="https://github.com/w3ctag/design-reviews/issues/313">discussion in the W3C Technical Architecture Group (TAG) about it</a> and I'd like to share my thoughts.</p>  
	<p></p>  

	<p>
		Here's why MathML this is particularly intresting to me on a few different levels, and why I think you should care too: The purpose, use, and unique challenges and history here - as well as what I think this says about the platform moving forward.
	</p> 

	<section class="sectioning">
		<contextual-heading role="heading" aria-level="2">Purpose</contextual-heading>
		<p>
			What it is <em>for</em> matters to me quite a lot.  The sites that most require formule might not be the Gmails, Twitters, Facebooks, news or marketing sites of the world.  But they <em>are</em> things like <em>cancer research, the National Science Foundation and higher education</em>.  Aside from the very plain fact that these are especially worthy things to care about, these are also kind of literally the folk the Web was originally conceived of as being very useful to.
		</p>
		<p>
			When those sorts of concerns come along and say "we need this" I feel like it's important for us to sit up and listen.  Doubly so since this is among the oldest problems on the Web.
		</p>
	</section>
	<section class="sectioning">
		<contextual-heading role="heading" aria-level="2">Oldest Web Problems</contextual-heading>
		<p>
			The corpus of documents at CERN that Tim drew the subset that would define HTML from probably had <em>many</em> more elements than the 15 or so that Tim chose.  SGML had 30 years worth of debate and thought around ways to deal with this.  There were ways to say "This is a document about an invoice" and for that to have different elements than, say, a book of poetry. Tim picked the most <em>common</em> ones as the original set, which also have the distinction of largely being the oldest, and least specifically semantic.
		</p>
		<p>
			Given this, it is perhaps not surprising that there has been a lot of desire and debate over the years about adding elements to HTML.  How do we provide the right "stuff" to support all of the use cases that wanted to use the Web.
		</p>

		<section class="sectioning">
			<contextual-heading role="heading" aria-level="3">An important history</contextual-heading>
			<p>
				From the very first year (nearly 30 years ago now), early adopters and enthusiasts of the Web began discussing the needs for two things in HTML which would keep coming up over and over: graphics and math. Within a very short window of time, Dave Ragget had assemebled a number of ideas for what he called "HTML+" which took (believe it or not) only a fraction of those ideas and would have created roughly five times as many elements as Tim's original browser supported.
			</p>

			<p>
				Notably among those proposals, <a href="https://www.w3.org/MarkUp/HTMLPlus/htmlplus_45.html">section 12 included a math element</a> and they had experimental browser support at CERN.
			</p>

			<div class="captioned-image">
				<img src="https://www.w3.org/MarkUp/htmlplus_paper/math2.gif" alt="">
				A screenshot of the experimental browser at CERN rendering the proposed <code tag-esc="">math</code> element in 1993.
			</div>


			<p>
				That proposal wasn't accepted, but it wasn't the end of the conversation. Details around math and graphics would wind up being figured out outside of HTML.
			</p>

			<p>
				By the time the "HTML5 era" rolled along, there was some degree of maturity and the new standard included at least some degree of answer for these two asks through <a href="https://html.spec.whatwg.org/multipage/embedded-content-other.html">its secion on "other" Embedded Content</a> which mentions only two specifically: SVG and MathML.
			</p>

			<section class="sectioning">
				<contextual-heading role="heading" aria-level="4">A Uniquely Tragic Twist</contextual-heading>
				<p>
					While SVG now has broad support, MathML has a bumpier story...
				</p>
				<p>   
					Firefox shipped some kind of MathML support as early as 2006. For a time just about every browser - Firefox, Webkit (Chrome and Apple at the time), and Opera (Presto) - had <em>someone</em> either working on implmentations or already shipped.
				</p>
				<p>  
					But along the way there was an unfortunate turn.  When Google created the new Blink engine, they decided to remove support and instead recommend use of a polyfill of sorts called MathJax. 
				</p>
				<p>
					Now, I think it would be a mistake to read too much into this.  I do not intend to ascribe any kind of ill intent to this decision:  Making a browser is full of tough choices and each team has to manage a lot of difficult priorities.  Blink did a lot of reviewing and refactoring and found that the newly landed contribution had a lot of complexity, issues, and even a security flaw.  Further, the feature had no long-term owner, so, they decided to take it out for the time being.
				</p>

				<p>
					So, any kind of judgement aside, this nevertheless had real world effects that have been pretty complex and bad for MathML... 
				</p>

				<div class="captioned-image">
					<img src="/media/fixed-it.gif" alt="">
				</div>
		 
				<p>
					Opera, for example, retired Presto to be built on Blink too.  So now there were two less browsers it looked like had support.  Because Blink has such a huge market share, this has also served to reduce pressure on the other implemeter (Microsoft).  What this means is that MathML is, after all this time, now only supported to some degree by about 23% of global browsers in use today (going by caniuse for this statistic).
				</p>
			</section>

			<section class="sectioning">
				<contextual-heading role="heading" aria-level="4">Dedication</contextual-heading>
				Over the years, a number of organizations have shown tremendous dedication, developing code, contributing open-source project, <a href="https://www.mathjax.org/#sponsors">funded development of polyfills</a> through MathJax and <a href="https://mathml.igalia.com/"> sponsoring efforts to get it widely implmented hrough Igalia</a>..
			</section>
					
			<section class="sectioning">
				<contextual-heading role="heading" aria-level="4">A measure of success</contextual-heading>
				<p>
					Measuing the 'uptake' of MathML is a little tricky precisely because of what it is.  Most means of measuring use that we have we tend to look at, for example, depend on a dataset of popular sites.  However, the sites that need MathML are, by their nature, unlikely to have comparatively broad audiences.
				</p>
				<p>
				  	Even 'heavy users'  probably spend quite a lot less time looking at formulae than they do any of the myriad of other things on the Web.
				</p>
				<p>
					The most frequent uses are also often behind something requiring login or user actions in order to get pages with <code tag-esc="">math</code> in them, thereby making them unavailable in a number of datasets that come from crawling.
				</p>
				<p>
				  Finally, because of what these sites are, they might ultimately  recommend a browser that <em>does</em> support MathML. That would be bad for the Web, but it would also keep those uses out of browser collected datasets.  I'll explain why they might do that below in the "Other kinds of success" section. 
				</p>
				<p>
					So, there are a spectrum of imperfect ways to measure a few different things.
				</p>
				<section class="sectioning">
					<contextual-heading role="heading" aria-level="5">Is there use?</contextual-heading>
					<p>
						So, whether a site loads JavaScript for MathML is one way, but there are multiple possible JavaScript solutions here.  Still, we can glean some kind of indicators.  builtwith.com, for example, lists nearly 70k _sites_ that use MathJax, specifically.  Now, MathJax supports more than just MathML, so that number could be artificially high.  Still, note carefully that that's not 70k instances of <code tag-esc="">math</code> tags, or even 70k pages with one or more <code tag-esc="">math</code> tags.  That's 70k <em>sites</em>  using one specific popular polyfill on what count as heavily trafficed sites.
					</p>
					<p>
					 	So, I think it is safe to say that it has use.  In fact, according to the community, there are millions of pages that rely on MathML.
					</p>
				</section>
				<section class="sectioning">
					<contextual-heading role="heading" aria-level="5">Other kinds of success</contextual-heading>

					<p> 
						But, are we successful if we have to load a polyfill for this forever?  I think not for several reasons.
					</p>

					<p>
						First, in this specific case there are a dance of dependencies.  First, some JavaScript to test whether you need the polyfill - then if you do, a JavaScript dependency which once loaded loads CSS and other JavaScript which once loaded load fonts.  Here's what that looks like in devtools.
					</p>
		
					<div class="captioned-image">
						<img src="/media/mathjax-waterfall.png" alt="">
						Devtools waterfall of loading the polyfill.
					</div>

					<p>  
						So, that's pretty terrible all on its own.  However, your site should be accessible too and many of the sites that need math also carry a legal <em>requirement</em> for accessibility.  But, because of where we are in history, and how this all played out, that's really tricky.
					</p>
					<p>
						MathJax tries valiantly to make it accessible, but it's a lot of work and complexity and I think not great for users.  
					</p>
					<p>
						In order to approach this today, they math into a focusable, interactive which includes an accessible menu.  The menu system is, of course, not native and not without it's own set of isssues, but through this menu they handle accessibility through self-voicing with the (not offically standardized) Web Speech APIs.
					</p>
					<p>
						This means that that users have to understand things about MathJax - how and when to manually toggle between the actual 'screen reader' and the simulated 'self voicing accessibility' and how that plays in with the menuing and so on.  It is far, far less than ideal and not easy.
					</p>
				</section>
			</section>
		</section>
	</section>


	<section class="sectioning">
		<contextual-heading role="heading" aria-level="2">How do we move forward?</contextual-heading>
		<p>
			There's a final aspect that makes this especially interesting to me, what does it say about the Web Platform moving forward?
		</p>
		<p>  
			Today, we say that the potential path to standardization of new elements lies in experimentation with Custom Elements to encourage communities to work together, experiment, compete, and prove that there is valuable 'slang' to be standardized.
		</p>

		<p>
			While Custom Elements didn't exist when the MathML community was doing there work, they did effectively do all of this and more.  Not only did they do all of that in terms of the Web alone, they built useful things atop those things in a rich ecosystem.  They also found  implmenter interest and even funding.  
		</p>
		<p>
			So, if MathML doesn't reach the bar - why? And what would?  What are our plans for things like this?  Do we have to treat MathML a little "specially" in this, and why?  Can we begin to articulate some of this?
		</p> 

		<p>
			How <em>do</em> we deal with one custom element (or in this very special case, speculative, non-dasherized element) becomming very mature and getting widely used within a subset community?  Should be ways short of "it becomes part of HTML" that are more complete than "Here's a JS file and CSS and fonts and... etc"?  And can we find a way to lower the runtime taxes that that implies?  That's a general topic I've been interested in discussing for many years.  
		</p>
	</section>

	<section class="sectioning">
		<contextual-heading role="heading" aria-level="2">Summing Up..</contextual-heading>
		<p>
			As for myself, I believe that all of this warrants us accepting existing MathML as our imperfect, but still valuable starting point and getting it implmented.  I realize what a big ask this is: It's a very significant effort and means effectively 'admitting' there is additional complexity in the platform that may make it harder for browsers to to do things like refactoring.  It means we'll have to work on explaining that new magic too so that we create new opportunites for inceasingly better answers to emerge.  It's a lot.
		</p>
		<p>
			Still, this is a <em>very</em> unique situation with what I think is a strong rationale and I really hope that the community continues its efforts to move this forward.  If you think think this is a valuable and worthwhile effort, be sure to speak up.  If you work for someone who thinks this is important, ask them to <a href="https://mathml.igalia.com/">help fund the efforts</a>.
		</p>
	</section>
</article></main>

  
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-88027178-1', 'auto');
    ga('send', 'pageview');
  </script>

  <script>
    Array.prototype.slice.call(document.querySelectorAll('.optional [data-src]')).forEach(function (optional) {
      var prefs = window.localStorage.downloadsPrefs,
          clickToSee;
      if (prefs === 'true') {
        activateOptional(optional);
      } else {
        clickToSee = document.createElement('div');
        clickToSee.classList.add('clickToSee')
        clickToSee.innerHTML = '<button>Click to see media</button>';
        clickToSee.style.textAlign = 'center';
        clickToSee.style.border = 'none';
        optional.parentElement.insertBefore(clickToSee, optional.nextSibling);
        clickToSee.firstElementChild.addEventListener('click', function () {
          activateOptional(optional);
        })
      }

    })
  </script>

</body></html>